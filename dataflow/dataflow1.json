{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DelimitedText1",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DelimitedText2",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "filter1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          state_id as string,",
				"          state_abbr as string,",
				"          county_state_name as string,",
				"          county_id as string,",
				"          county_name as string,",
				"          latitude as string,",
				"          longitude as string,",
				"          {consolidated_city-county} as string,",
				"          population as string,",
				"          population_cohort as string,",
				"          employment as string,",
				"          employment_cohort as string,",
				"          doe_climate_zone as string,",
				"          cohort as string,",
				"          {consumption (MWh)14} as string,",
				"          {expenditures in Millions15} as string,",
				"          {consumption (MWh/capita)16} as string,",
				"          {expenditures in Millions17} as string,",
				"          {utility customers18} as string,",
				"          {GHG emissions mtons CO2e} as string,",
				"          {consumption (TcF)20} as string,",
				"          {expenditures in Millions21} as string,",
				"          {consumption (TcF/capita)22} as string,",
				"          {expenditures in Millions23} as string,",
				"          {utility customers24} as string,",
				"          {occuped housing units} as string,",
				"          {consumption (MWh)26} as string,",
				"          {expenditures in Millions27} as string,",
				"          {consumption (MWh/capita)28} as string,",
				"          {expenditures in Millions29} as string,",
				"          {consumption (MWh)30} as string,",
				"          {expenditures in Millions31} as string,",
				"          {utility customers32} as string,",
				"          {consumption (TcF)33} as string,",
				"          {expenditures in Millions34} as string,",
				"          {consumption (TcF/capita)35} as string,",
				"          {expenditures in Millions36} as string,",
				"          {consumption (TcF)37} as string,",
				"          {expenditures in Millions38} as string,",
				"          {utility customers39} as string,",
				"          buildings as string,",
				"          {area (sq. ft.)} as string,",
				"          {consumption (gallons)42} as string,",
				"          {consumption (gallons/capita)43} as string,",
				"          {consumption (gallons)44} as string,",
				"          {consumption (gallons/capita)45} as string,",
				"          {vehicle miles traveled (miles)} as string,",
				"          {vehicle miles traveled (miles/capita)} as string,",
				"          {consumption (MWh)48} as string,",
				"          {expenditures in Millions49} as string,",
				"          {consumption (MWh/capita)50} as string,",
				"          {consumption (TcF)51} as string,",
				"          {expenditures in Millions52} as string,",
				"          {consumption (TcF/capita)53} as string,",
				"          {expenditures in Millions54} as string,",
				"          establishments as string,",
				"          {consumption (MWh)56} as string,",
				"          {expenditures in Millions57} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> source1",
				"source1 filter(toInteger(population) <= 300000 && toInteger(population) >=50000 && rlike(state_abbr, 'TX')) ~> filter1",
				"filter1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          state_id as string,",
				"          state_abbr as string,",
				"          county_state_name as string,",
				"          county_id as string,",
				"          county_name as string,",
				"          latitude as string,",
				"          longitude as string,",
				"          {consolidated_city-county} as string,",
				"          population as string,",
				"          population_cohort as string,",
				"          employment as string,",
				"          employment_cohort as string,",
				"          doe_climate_zone as string,",
				"          cohort as string,",
				"          {consumption (MWh)14} as string,",
				"          {expenditures in Millions15} as string,",
				"          {consumption (MWh/capita)16} as string,",
				"          {expenditures in Millions17} as string,",
				"          {utility customers18} as string,",
				"          {GHG emissions mtons CO2e} as string,",
				"          {consumption (TcF)20} as string,",
				"          {expenditures in Millions21} as string,",
				"          {consumption (TcF/capita)22} as string,",
				"          {expenditures in Millions23} as string,",
				"          {utility customers24} as string,",
				"          {occuped housing units} as string,",
				"          {consumption (MWh)26} as string,",
				"          {expenditures in Millions27} as string,",
				"          {consumption (MWh/capita)28} as string,",
				"          {expenditures in Millions29} as string,",
				"          {consumption (MWh)30} as string,",
				"          {expenditures in Millions31} as string,",
				"          {utility customers32} as string,",
				"          {consumption (TcF)33} as string,",
				"          {expenditures in Millions34} as string,",
				"          {consumption (TcF/capita)35} as string,",
				"          {expenditures in Millions36} as string,",
				"          {consumption (TcF)37} as string,",
				"          {expenditures in Millions38} as string,",
				"          {utility customers39} as string,",
				"          buildings as string,",
				"          {area (sq. ft.)} as string,",
				"          {consumption (gallons)42} as string,",
				"          {consumption (gallons/capita)43} as string,",
				"          {consumption (gallons)44} as string,",
				"          {consumption (gallons/capita)45} as string,",
				"          {vehicle miles traveled (miles)} as string,",
				"          {vehicle miles traveled (miles/capita)} as string,",
				"          {consumption (MWh)48} as string,",
				"          {expenditures in Millions49} as string,",
				"          {consumption (MWh/capita)50} as string,",
				"          {consumption (TcF)51} as string,",
				"          {expenditures in Millions52} as string,",
				"          {consumption (TcF/capita)53} as string,",
				"          {expenditures in Millions54} as string,",
				"          establishments as string,",
				"          {consumption (MWh)56} as string,",
				"          {expenditures in Millions57} as string",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> sink1"
			]
		}
	}
}